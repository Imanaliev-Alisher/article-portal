@model IEnumerable<ContentPortal.Models.Category>
@{
    ViewData["Title"] = "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏";
}

<div class="d-flex justify-content-between align-items-center mb-4">
    <h2>@ViewData["Title"]</h2>
    <a asp-action="CreateCategory" class="btn btn-primary">–°–æ–∑–¥–∞—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é</a>
</div>

@if (TempData["Success"] != null)
{
    <div class="alert alert-success alert-dismissible fade show">
        @TempData["Success"]
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    </div>
}

<div class="card">
    <div class="card-body">
        <div class="table-responsive">
            <table class="table table-hover">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
                        <th>–û–ø–∏—Å–∞–Ω–∏–µ</th>
                        <th>–°—Ç–∞—Ç–µ–π</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    @foreach (var category in Model)
                    {
                        <tr>
                            <td>@category.Id</td>
                            <td><strong>@category.Name</strong></td>
                            <td>@(category.Description ?? "‚Äî")</td>
                            <td>
                                <span class="badge bg-primary">@category.Articles.Count</span>
                            </td>
                            <td>
                                <div class="btn-group" role="group">
                                    <a asp-action="EditCategory" asp-route-id="@category.Id" 
                                       class="btn btn-sm btn-outline-secondary" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                        ‚úèÔ∏è –ò–∑–º–µ–Ω–∏—Ç—å
                                    </a>
                                    <button type="button" class="btn btn-sm btn-outline-danger" 
                                            data-bs-toggle="modal" data-bs-target="#deleteModal@(category.Id)" title="–£–¥–∞–ª–∏—Ç—å"
                                            @(category.Articles.Count > 0 ? "disabled" : "")>
                                        üóëÔ∏è –£–¥–∞–ª–∏—Ç—å
                                    </button>
                                </div>

                                @if (category.Articles.Count == 0)
                                {
                                    <!-- Modal -->
                                    <div class="modal fade" id="deleteModal@(category.Id)" tabindex="-1">
                                        <div class="modal-dialog">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title">–£–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é?</h5>
                                                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                                </div>
                                                <div class="modal-body">
                                                    <p>–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é "<strong>@category.Name</strong>"?</p>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">–û—Ç–º–µ–Ω–∞</button>
                                                    <form asp-action="DeleteCategory" method="post" class="d-inline">
                                                        <input type="hidden" name="id" value="@category.Id" />
                                                        @Html.AntiForgeryToken()
                                                        <button type="submit" class="btn btn-danger">–£–¥–∞–ª–∏—Ç—å</button>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                }
                            </td>
                        </tr>
                    }
                </tbody>
            </table>
        </div>
    </div>
</div>

<div class="alert alert-info mt-3">
    <strong>‚ÑπÔ∏è –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:</strong> –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ —Å–æ —Å—Ç–∞—Ç—å—è–º–∏ –Ω–µ–ª—å–∑—è —É–¥–∞–ª–∏—Ç—å. –°–Ω–∞—á–∞–ª–∞ —É–¥–∞–ª–∏—Ç–µ –∏–ª–∏ –ø–µ—Ä–µ–º–µ—Å—Ç–∏—Ç–µ —Å—Ç–∞—Ç—å–∏ –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
</div>

<div class="mt-3">
    <a asp-action="Index" class="btn btn-secondary">–ù–∞–∑–∞–¥ –∫ –ø–∞–Ω–µ–ª–∏</a>
</div>
